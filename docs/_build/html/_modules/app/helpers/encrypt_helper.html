<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>app.helpers.encrypt_helper &#8212; hidden 1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=29a6c3e3"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for app.helpers.encrypt_helper</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The module provides functions for encrypting and decrypting data of</span>
<span class="sd">types such as bytes, strings, integers, and booleans using AES</span>
<span class="sd">encryption with PBKDF2 key derivation. It also includes functionality</span>
<span class="sd">for generating cryptographic salts and hashing string values using</span>
<span class="sd">the SHA-512 algorithm.</span>

<span class="sd">Original | Encrypted</span>
<span class="sd">length   | length</span>
<span class="sd">---------|----------</span>
<span class="sd">15       | 64</span>
<span class="sd">31       | 88</span>
<span class="sd">47       | 108</span>
<span class="sd">63       | 128</span>
<span class="sd">79       | 152</span>
<span class="sd">95       | 172</span>
<span class="sd">111      | 192</span>
<span class="sd">127      | 216</span>
<span class="sd">255      | 384</span>
<span class="sd">511      | 728</span>
<span class="sd">1023     | 1408</span>
<span class="sd">2047     | 2776</span>
<span class="sd">4095     | 5504</span>
<span class="sd">16383    | 21888</span>
<span class="sd">32767    | 43736</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Union</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.kdf.pbkdf2</span><span class="w"> </span><span class="kn">import</span> <span class="n">PBKDF2HMAC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.backends</span><span class="w"> </span><span class="kn">import</span> <span class="n">default_backend</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.ciphers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cipher</span><span class="p">,</span> <span class="n">algorithms</span><span class="p">,</span> <span class="n">modes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">padding</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">app.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">app.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_context</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span>
<span class="n">ctx</span> <span class="o">=</span> <span class="n">get_context</span><span class="p">()</span>


<div class="viewcode-block" id="generate_encryption_salt">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.generate_encryption_salt">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">generate_encryption_salt</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a random byte sequence to be used as a salt for AES key</span>
<span class="sd">    derivation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">CRYPTOGRAPHY_SALT_LENGTH</span><span class="p">)</span></div>



<div class="viewcode-block" id="extract_aes_key">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.extract_aes_key">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">extract_aes_key</span><span class="p">(</span><span class="n">secret_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">salt</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Derives a cryptographic AES key from a given secret string and salt</span>
<span class="sd">    using the PBKDF2 algorithm with HMAC-SHA256.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kdf</span> <span class="o">=</span> <span class="n">PBKDF2HMAC</span><span class="p">(</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span> <span class="n">length</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">CRYPTOGRAPHY_KEY_LENGTH</span><span class="p">,</span>
        <span class="n">salt</span><span class="o">=</span><span class="n">salt</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">CRYPTOGRAPHY_PBKDF2_ITERATIONS</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="n">default_backend</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">kdf</span><span class="o">.</span><span class="n">derive</span><span class="p">(</span><span class="n">secret_key</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span></div>



<div class="viewcode-block" id="encrypt_bytes">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.encrypt_bytes">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">encrypt_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Encrypts a byte sequence using AES in CBC mode with PKCS7 padding</span>
<span class="sd">    and returns the encrypted data, which includes the salt, IV, and</span>
<span class="sd">    ciphertext.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">salt</span> <span class="o">=</span> <span class="n">generate_encryption_salt</span><span class="p">()</span>
    <span class="n">iv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">CRYPTOGRAPHY_IV_LENGTH</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">extract_aes_key</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">secret_key</span><span class="p">,</span> <span class="n">salt</span><span class="p">)</span>

    <span class="n">algorithm</span> <span class="o">=</span> <span class="n">algorithms</span><span class="o">.</span><span class="n">AES</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">modes</span><span class="o">.</span><span class="n">CBC</span><span class="p">(</span><span class="n">iv</span><span class="p">)</span>

    <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">(</span><span class="n">algorithm</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">default_backend</span><span class="p">())</span>
    <span class="n">encryptor</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encryptor</span><span class="p">()</span>

    <span class="n">padder</span> <span class="o">=</span> <span class="n">padding</span><span class="o">.</span><span class="n">PKCS7</span><span class="p">(</span><span class="n">algorithms</span><span class="o">.</span><span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span><span class="o">.</span><span class="n">padder</span><span class="p">()</span>
    <span class="n">padded_data</span> <span class="o">=</span> <span class="n">padder</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="n">padder</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">padded_data</span><span class="p">)</span> <span class="o">+</span> <span class="n">encryptor</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

    <span class="n">encrypted_data</span> <span class="o">=</span> <span class="n">salt</span> <span class="o">+</span> <span class="n">iv</span> <span class="o">+</span> <span class="n">ciphertext</span>
    <span class="k">return</span> <span class="n">encrypted_data</span></div>



<div class="viewcode-block" id="decrypt_bytes">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.decrypt_bytes">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">decrypt_bytes</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decrypts a byte sequence previously encrypted with AES by extracting</span>
<span class="sd">    the salt and IV, deriving the key, and removing padding from the</span>
<span class="sd">    plaintext.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">encrypted_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Extract the salt and IV from the encrypted data</span>
    <span class="n">salt</span> <span class="o">=</span> <span class="n">encrypted_data</span><span class="p">[:</span><span class="n">cfg</span><span class="o">.</span><span class="n">CRYPTOGRAPHY_SALT_LENGTH</span><span class="p">]</span>
    <span class="n">iv</span> <span class="o">=</span> <span class="n">encrypted_data</span><span class="p">[</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">CRYPTOGRAPHY_SALT_LENGTH</span><span class="p">:</span><span class="n">cfg</span><span class="o">.</span><span class="n">CRYPTOGRAPHY_SALT_LENGTH</span> <span class="o">+</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">CRYPTOGRAPHY_IV_LENGTH</span><span class="p">]</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">encrypted_data</span><span class="p">[</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">CRYPTOGRAPHY_SALT_LENGTH</span> <span class="o">+</span> <span class="n">cfg</span><span class="o">.</span><span class="n">CRYPTOGRAPHY_IV_LENGTH</span><span class="p">:]</span>

    <span class="c1"># Derive the AES key using the salt</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">extract_aes_key</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">secret_key</span><span class="p">,</span> <span class="n">salt</span><span class="p">)</span>

    <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">(</span>
        <span class="n">algorithms</span><span class="o">.</span><span class="n">AES</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">modes</span><span class="o">.</span><span class="n">CBC</span><span class="p">(</span><span class="n">iv</span><span class="p">),</span> <span class="n">backend</span><span class="o">=</span><span class="n">default_backend</span><span class="p">())</span>
    <span class="n">decryptor</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decryptor</span><span class="p">()</span>

    <span class="c1"># Decrypt and unpad the ciphertext</span>
    <span class="n">padded_data</span> <span class="o">=</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span> <span class="o">+</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
    <span class="n">unpadder</span> <span class="o">=</span> <span class="n">padding</span><span class="o">.</span><span class="n">PKCS7</span><span class="p">(</span><span class="n">algorithms</span><span class="o">.</span><span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span><span class="o">.</span><span class="n">unpadder</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">unpadder</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">padded_data</span><span class="p">)</span> <span class="o">+</span> <span class="n">unpadder</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">data</span></div>



<div class="viewcode-block" id="encrypt_str">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.encrypt_str">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">encrypt_str</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Encrypts a string using AES and returns the result as a</span>
<span class="sd">    base64-encoded string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">encrypted_data</span> <span class="o">=</span> <span class="n">encrypt_bytes</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="decrypt_str">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.decrypt_str">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">decrypt_str</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decodes a base64-encoded encrypted string, decrypts it using AES,</span>
<span class="sd">    and returns the original string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">encrypted_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">encrypted_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">)</span>
    <span class="n">decrypted_data</span> <span class="o">=</span> <span class="n">decrypt_bytes</span><span class="p">(</span><span class="n">encrypted_bytes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">decrypted_data</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></div>



<div class="viewcode-block" id="encrypt_int">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.encrypt_int">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">encrypt_int</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Encrypts an integer by converting it to a string and applying string</span>
<span class="sd">    encryption, returning a base64-encoded result.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">encrypt_str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div>



<div class="viewcode-block" id="decrypt_int">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.decrypt_int">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">decrypt_int</span><span class="p">(</span><span class="n">encrypted_value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decrypts a base64-encoded string representing an encrypted integer</span>
<span class="sd">    and returns the original integer value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">encrypted_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">decrypt_str</span><span class="p">(</span><span class="n">encrypted_value</span><span class="p">))</span></div>



<div class="viewcode-block" id="encrypt_bool">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.encrypt_bool">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">encrypt_bool</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Encrypts a boolean value by converting it to an integer and</span>
<span class="sd">    encrypting the result as a base64-encoded string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">encrypt_int</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div>



<div class="viewcode-block" id="decrypt_bool">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.decrypt_bool">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">decrypt_bool</span><span class="p">(</span><span class="n">encrypted_value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decrypts a base64-encoded string representing an encrypted boolean</span>
<span class="sd">    and returns the original boolean value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">encrypted_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">decrypt_int</span><span class="p">(</span><span class="n">encrypted_value</span><span class="p">))</span></div>



<div class="viewcode-block" id="hash_str">
<a class="viewcode-back" href="../../../autodoc/app.helpers.html#app.helpers.encrypt_helper.hash_str">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">hash_str</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hashes a string concatenated with the application&#39;s secret key using</span>
<span class="sd">    SHA-512 and returns the hexadecimal digest.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">encoded_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">+</span> <span class="n">ctx</span><span class="o">.</span><span class="n">secret_key</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="nb">hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">(</span><span class="n">encoded_value</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">hidden</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../autodoc/app.html">app package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autodoc/app.decorators.html">app.decorators package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autodoc/app.helpers.html">app.helpers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autodoc/app.managers.html">app.managers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autodoc/app.models.html">app.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autodoc/app.routers.html">app.routers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autodoc/app.schemas.html">app.schemas package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Artem Abramov.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>